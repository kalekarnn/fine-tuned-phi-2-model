/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_auth.py:86: UserWarning: 
Access to the secret `HF_TOKEN` has not been granted on this notebook.
You will not be requested again.
Please restart the session if you want to be prompted again.
  warnings.warn(
Loading checkpoint shards: 100%
 2/2 [00:03<00:00,  1.68s/it]
Building conversation threads...

Formatting conversations...
Final dataset size: 9846 conversations
Converting train dataset to ChatML: 100%
 9846/9846 [00:00<00:00, 44008.01 examples/s]
Applying chat template to train dataset: 100%
 9846/9846 [00:00<00:00, 32524.20 examples/s]
Tokenizing train dataset: 100%
 9846/9846 [00:12<00:00, 747.17 examples/s]
Token indices sequence length is longer than the specified maximum sequence length for this model (2362 > 2048). Running this sequence through the model will result in indexing errors
Truncating train dataset: 100%
 9846/9846 [00:04<00:00, 2186.89 examples/s]
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
/usr/local/lib/python3.11/dist-packages/torch/_dynamo/eval_frame.py:745: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
 [500/500 1:16:09, Epoch 0/1]
Step	Training Loss
1	1.866700
2	1.792300
3	1.417800
4	1.926800
5	2.298900
6	1.572600
7	1.759900
8	2.015600
9	2.005500
10	2.429700
11	1.712200
12	1.799700
13	2.451800
14	1.500800
15	2.276100
16	2.168300
17	1.701000
18	1.553700
19	1.318300
20	2.720700
21	2.000200
22	1.423000
23	2.253800
24	1.649700
25	2.307700
26	1.434400
27	2.427200
28	1.502900
29	1.632800
30	1.519300
31	2.545400
32	2.068300
33	1.551200
34	1.534600
35	1.541100
36	2.274900
37	1.428700
38	1.679800
39	1.242500
40	1.396100
41	1.964600
42	1.664300
43	1.873900
44	2.327400
45	1.884700
46	2.292900
47	1.571500
48	1.906200
49	2.018900
50	1.430800
51	1.622400
52	1.579400
53	2.040800
54	1.813000
55	2.236900
56	1.889500
57	2.141900
58	2.446900
59	2.118300
60	1.114000
61	1.864100
62	1.616800
63	1.913700
64	1.638000
65	2.243100
66	2.103900
67	2.147400
68	1.584200
69	1.876400
70	1.131700
71	1.687300
72	1.581500
73	1.965700
74	1.605400
75	1.999100
76	1.874100
77	1.677900
78	1.729200
79	2.149900
80	1.625500
81	2.315700
82	2.214400
83	1.698300
84	2.251600
85	2.651000
86	1.838900
87	1.543200
88	2.026800
89	2.647500
90	0.879700
91	1.453000
92	2.460800
93	2.654600
94	1.475300
95	1.781000
96	2.538500
97	1.896700
98	1.334400
99	1.333800
100	2.368200
101	1.425200
102	1.598200
103	1.582500
104	1.570300
105	1.396900
106	2.162600
107	3.300200
108	1.534800
109	1.694000
110	1.440400
111	2.071200
112	2.326500
113	1.185200
114	1.495100
115	1.345500
116	1.697600
117	1.845700
118	1.768700
119	1.371400
120	1.762000
121	2.084100
122	1.777700
123	1.392000
124	2.748000
125	1.506700
126	1.879700
127	1.997500
128	1.281700
129	1.380600
130	1.978900
131	1.989200
132	2.113900
133	1.906100
134	1.726600
135	1.598700
136	1.919100
137	1.484100
138	1.368900
139	2.200000
140	2.214500
141	1.393600
142	0.942700
143	1.894700
144	1.476000
145	2.080500
146	1.742900
147	1.826600
148	1.992600
149	2.540000
150	1.963800
151	1.304000
152	2.512000
153	1.179100
154	2.027400
155	2.245800
156	2.132500
157	1.924700
158	1.572800
159	1.699800
160	1.832200
161	1.253800
162	1.747800
163	1.579900
164	1.894300
165	2.124600
166	1.556100
167	2.158500
168	2.245100
169	1.694800
170	1.787200
171	2.137500
172	1.658700
173	1.891700
174	1.752100
175	2.102500
176	1.369800
177	1.615000
178	1.932800
179	1.589400
180	2.283700
181	1.207700
182	2.586700
183	1.743600
184	1.584300
185	3.727500
186	1.541200
187	1.345800
188	2.310700
189	2.217000
190	2.025000
191	1.222800
192	1.835800
193	1.888700
194	2.067800
195	1.471800
196	1.955600
197	1.824200
198	1.988000
199	2.131700
200	1.784100
201	1.944900
202	1.702700
203	1.387000
204	1.394500
205	2.060500
206	1.517400
207	1.963000
208	1.943600
209	2.114200
210	1.429500
211	2.570000
212	1.550800
213	2.022400
214	1.584100
215	1.301400
216	2.333700
217	1.641100
218	2.275400
219	1.161300
220	1.786900
221	2.045500
222	1.831000
223	1.596200
224	2.262300
225	1.842300
226	2.155400
227	2.659000
228	1.945900
229	1.784300
230	2.038200
231	1.738900
232	1.849600
233	2.410600
234	1.748200
235	1.427900
236	1.234200
237	1.673700
238	1.688200
239	1.702900
240	3.106300
241	1.677000
242	1.899900
243	2.292300
244	2.245700
245	1.272100
246	1.810100
247	1.860000
248	1.890700
249	1.260200
250	1.151100
251	1.531100
252	1.865200
253	1.517000
254	1.700200
255	1.317700
256	1.549900
257	1.420000
258	1.808400
259	1.742200
260	1.377100
261	1.704600
262	1.220800
263	2.077600
264	1.805300
265	2.339800
266	1.397300
267	1.818300
268	1.663900
269	1.188000
270	1.253200
271	1.653900
272	1.762700
273	1.161900
274	1.873600
275	1.139500
276	1.081500
277	1.149700
278	1.622200
279	1.613600
280	1.696700
281	1.834600
282	1.787700
283	1.664600
284	1.616700
285	2.017400
286	2.022300
287	1.389300
288	1.617500
289	1.975300
290	1.881700
291	1.485100
292	1.756900
293	1.910300
294	1.555900
295	1.817200
296	2.592600
297	2.113000
298	2.173800
299	2.492300
300	1.603800
301	2.071800
302	2.147400
303	1.687000
304	1.776700
305	1.822200
306	2.196100
307	1.613300
308	1.680600
309	1.341900
310	1.432700
311	1.997400
312	2.670200
313	2.043300
314	1.918300
315	1.941000
316	1.482100
317	1.589700
318	1.827400
319	2.072700
320	2.325600
321	1.730600
322	2.030000
323	1.943000
324	1.195400
325	1.452000
326	2.011000
327	2.331500
328	1.386700
329	1.561600
330	1.346900
331	1.994800
332	1.766600
333	2.024300
334	2.218000
335	1.862500
336	1.708500
337	2.422900
338	2.121200
339	1.695600
340	2.421400
341	1.619200
342	1.601500
343	2.128400
344	1.618000
345	2.327500
346	1.648100
347	1.867700
348	2.225900
349	1.814500
350	1.533600
351	1.693800
352	2.284900
353	1.317000
354	1.714600
355	2.817100
356	1.603500
357	2.603100
358	1.544400
359	1.580200
360	1.573700
361	1.820200
362	1.421100
363	1.600700
364	1.860900
365	1.351600
366	2.242000
367	2.118000
368	2.137200
369	2.183100
370	1.967900
371	1.404900
372	2.174100
373	2.163500
374	1.905800
375	1.680000
376	3.082300
377	1.373000
378	1.310200
379	2.146100
380	1.564700
381	2.283400
382	1.448400
383	1.804200
384	2.084400
385	2.363100
386	1.471000
387	1.896500
388	1.528000
389	1.677700
390	2.122600
391	1.466400
392	1.967500
393	1.619800
394	2.351100
395	1.652800
396	1.353500
397	1.165800
398	2.007600
399	1.934000
400	2.212800
401	1.314100
402	1.681100
403	3.045000
404	3.178700
405	1.438900
406	1.710500
407	2.194200
408	1.818400
409	1.736400
410	1.717800
411	1.919100
412	1.035000
413	2.100900
414	1.214100
415	1.367400
416	1.182400
417	1.755600
418	2.203500
419	1.795300
420	1.827300
421	1.740200
422	1.892100
423	2.184600
424	1.474200
425	1.387600
426	2.311500
427	1.380000
428	2.262800
429	1.592300
430	1.579900
431	1.842100
432	1.560500
433	1.823000
434	2.315400
435	1.702700
436	1.621900
437	3.127700
438	1.523000
439	2.095200
440	2.332500
441	1.828600
442	1.635600
443	1.423600
444	1.872500
445	1.672800
446	1.830600
447	2.222500
448	1.596100
449	1.552200
450	1.951200
451	3.157900
452	1.717600
453	2.434100
454	1.946900
455	1.518000
456	1.499000
457	1.532900
458	1.853900
459	2.348200
460	1.178400
461	1.243100
462	2.457100
463	1.627100
464	1.351000
465	1.622700
466	2.213100
467	2.204100
468	1.277600
469	1.600700
470	2.305300
471	1.627200
472	1.855800
473	1.806200
474	1.893300
475	1.102900
476	1.745200
477	2.233800
478	1.735900
479	1.976900
480	2.451500
481	1.973300
482	1.483600
483	1.911600
484	1.755600
485	1.753400
486	1.620800
487	1.377800
488	1.529100
489	1.521700
490	1.863700
491	2.148000
492	1.571100
493	1.495500
494	1.800300
495	1.606800
496	2.411700
497	1.586800
498	1.428100
499	2.013600
500	2.405500
Model saved in PyTorch format at: phi2-finetuned-final/model.pt
✅ Training complete. Model saved.